<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools to create and manipulate closures • closure</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools to create and manipulate closures">
<meta property="og:description" content="Closures are often a poorman alternative to OOP (object oriental  programming), not only because they could be easier implemented but because they are fast. However, it is quite easy to get things wrong if one is not careful enough. Tools are provided to create and manipulate closures.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">closure</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/randy3k/closure/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="tools-to-create-and-manipulate-closures" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tools-to-create-and-manipulate-closures" class="anchor"></a>Tools to create and manipulate closures</h1></div>
<p><strong>WORKING IN PROGESS</strong></p>
<!-- badges: start -->
<!-- badges: end -->
<p>Closures are often a poorman alternative to OOP (object oriental programming), not only because they could be easier implemented but because they are fast. However, it is quite easy to get things wrong if one is not careful enough. Tools are provided to create and manipulate closures.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of closure from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"closure"</span>)  <span class="co"># not yet released</span></pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"randy3k/closure"</span>)</pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">closure</span>)

<span class="no">Foo1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/new_closure.html">new_closure</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">counter</span> <span class="kw">=</span> <span class="kw">NULL</span>,
    <span class="kw">initialize</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) {
        <span class="no">counter</span> <span class="kw">&lt;&lt;-</span> <span class="no">x</span>
    },
    <span class="kw">add</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) {
        <span class="no">counter</span> <span class="kw">&lt;&lt;-</span> <span class="no">counter</span> + <span class="no">x</span>
        <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="no">self</span>)
    }
))
<span class="no">foo1</span> <span class="kw">&lt;-</span> <span class="fu">Foo1</span>(<span class="fl">1</span>)
<span class="no">foo1</span>$<span class="fu">add</span>(<span class="fl">3</span>)$<span class="no">counter</span>
<span class="co">#&gt; [1] 4</span>

<span class="no">Foo2</span> <span class="kw">&lt;-</span> <span class="fu">toR6</span>(<span class="st">"Foo2"</span>, <span class="no">Foo1</span>)
<span class="no">foo2</span> <span class="kw">&lt;-</span> <span class="no">Foo2</span>$<span class="fu">new</span>(<span class="fl">1</span>)
<span class="no">foo2</span>$<span class="fu">add</span>(<span class="fl">3</span>)$<span class="no">counter</span>
<span class="co">#&gt; [1] 4</span></pre></div>
</div>
<div id="why" class="section level2">
<h2 class="hasAnchor">
<a href="#why" class="anchor"></a>Why?</h2>
<p>First of all, closures are much faster.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/bench/man/mark.html">mark</a></span>(
    <span class="kw">closure</span> <span class="kw">=</span> <span class="no">foo1</span>$<span class="fu">add</span>(<span class="fl">3</span>)$<span class="no">counter</span>,
    <span class="kw">R6</span> <span class="kw">=</span> <span class="no">foo2</span>$<span class="fu">add</span>(<span class="fl">3</span>)$<span class="no">counter</span>
)
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 closure      1.07µs   1.28µs   471158.        0B      0  </span>
<span class="co">#&gt; 2 R6           5.99µs   6.69µs    95307.        0B     19.1</span></pre></div>
<p>And it is incredibly easier to make things wrong.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">g</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">k</span>) {
    <span class="kw">function</span>(<span class="no">x</span>) {
        <span class="no">x</span>^<span class="no">k</span>
    }
}
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">h1</span> <span class="kw">&lt;-</span> <span class="fu">g</span>(<span class="fl">2</span>)
<span class="no">h2</span> <span class="kw">&lt;-</span> <span class="fu">g</span>(<span class="no">m</span>)
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">3</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu">h1</span>(<span class="fl">2</span>), <span class="fu">h2</span>(<span class="fl">2</span>))
<span class="co">#&gt; [1] FALSE</span></pre></div>
<p>See also, <a href="https://adv-r.hadley.nz/function-factories.html#forcing-evaluation">advanced-R</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/randy3k/closure/">https://​github.com/​randy3k/​closure/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/randy3k/closure/issues">https://​github.com/​randy3k/​closure/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Randy Lai <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Randy Lai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
